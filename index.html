<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover"
    />
    <meta name="theme-color" content="#0a5d5a" />
    <meta name="description" content="南非旅行多日行程 PWA：每日卡片、地图导航、离线可用、附件本地保存。" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="icon" href="icons/icon-192.svg" type="image/svg+xml" />
    <link rel="icon" href="icons/icon-192.png" type="image/png" sizes="192x192" />
    <link rel="apple-touch-icon" href="icons/icon-180.png" sizes="180x180" />
    <link rel="stylesheet" href="styles.css?v=20260208-7" />
    <title>南非旅行助手 · 2026-02-12</title>
  </head>
  <body>
    <header class="hero">
      <div class="hero-top">
        <div class="date-switcher hero-date-switcher">
          <button id="prevDateBtn" class="date-nav" type="button" aria-label="前一天">◀</button>
          <select id="dateSelect" aria-label="选择日期"></select>
          <button id="nextDateBtn" class="date-nav" type="button" aria-label="后一天">▶</button>
        </div>
      </div>
      <h1 id="currentTitle">约翰内斯堡抵达日（轻量、安全优先）</h1>
      <p id="currentSubtitle" class="subtitle">落地缓冲 + 酒店接送半日团，减少变量，稳定开局</p>
      <button id="installBtn" hidden>安装到手机</button>
    </header>

    <main>
      <section id="dailyMapCard" class="card daily-card">
        <h2>地图总览</h2>
        <div class="map-wrap">
          <iframe
            id="mapFrame"
            title="当天路线地图"
            loading="lazy"
            src="https://www.google.com/maps?q=-33.9849,25.6173&z=9&output=embed"
          ></iframe>
        </div>
        <div class="actions" id="routeActions"></div>
      </section>

      <section id="dailyTimelineCard" class="card daily-card">
        <h2>当天行程</h2>
        <ol id="timeline" class="timeline"></ol>
      </section>

      <section id="dailyImportCard" class="card daily-card">
        <h2 id="importTitle">行程资料导入（隐私）</h2>
        <p id="importHint" class="note">可上传当天资料（PDF/图片等），仅保存在本机浏览器。</p>
        <div id="importsPanel" class="imports"></div>
      </section>

      <section id="dailyWarningsCard" class="card daily-card">
        <h2>当天提醒</h2>
        <ul id="warnings" class="warnings"></ul>
      </section>

      <section id="dailyDocsCard" class="card daily-card">
        <h2>行程资料</h2>
        <ul id="docs" class="docs"></ul>
      </section>

      <section id="summaryItineraryCard" class="card summary-card" hidden>
        <h2>汇总：每天主要行程</h2>
        <ul id="summaryItineraryList" class="summary-list"></ul>
      </section>

      <section id="summaryEmbassyCard" class="card summary-card" hidden>
        <h2>中国驻南非使领馆联系方式</h2>
        <ul id="embassyContacts" class="summary-list embassy-list"></ul>
        <p class="note">联系方式可能变动，请以官方页面为准。</p>
      </section>

      <section id="summaryFuelCard" class="card summary-card" hidden>
        <h2>在南非加油步骤（是否要给小费）</h2>
        <ol id="fuelGuideList" class="summary-list summary-ordered-list"></ol>
      </section>

      <section id="summaryDocsCard" class="card summary-card" hidden>
        <h2>旅程资料添加（支持多个附件）</h2>
        <div class="summary-remark-controls">
          <label for="summaryDocsDate">选择日期</label>
          <select id="summaryDocsDate" aria-label="旅程资料日期"></select>
          <label>上传资料（可多选）
            <input id="summaryItineraryDocsInput" type="file" multiple />
          </label>
        </div>
        <p id="summaryDocsStatus" class="note">尚未选择日期</p>
        <ul id="summaryDocsList" class="summary-list"></ul>
      </section>

      <section id="summaryRemarksCard" class="card summary-card" hidden>
        <h2>备注按天汇总（可保存到 iPhone 记事本）</h2>
        <div class="summary-remark-controls">
          <label for="summaryRemarkStartDate">从该日期开始提取后续备注</label>
          <select id="summaryRemarkStartDate" aria-label="备注汇总起始日期"></select>
          <div class="actions">
            <button id="buildRemarksSummaryBtn" class="btn" type="button">生成按天汇总</button>
            <button id="shareRemarksToNotesBtn" class="btn" type="button">保存到 iPhone 记事本</button>
          </div>
        </div>
        <pre id="summaryRemarkPreview" class="remark-preview">点击“生成按天汇总”后显示内容</pre>
      </section>

      <section id="summaryPlacesCard" class="card summary-card" hidden>
        <h2>Google Maps 南非关注地点</h2>
        <p class="note">
          已根据你提供的 Google Takeout 导出文件自动加载。你也可以粘贴 Google Maps 链接手动提取。
        </p>
        <div class="summary-place-manual">
          <label for="mapPlacesTextInput">粘贴地点链接（每行一个）</label>
          <textarea id="mapPlacesTextInput" rows="3" placeholder="https://maps.app.goo.gl/xxxx"></textarea>
          <div class="actions">
            <button id="parseMapPlacesTextBtn" class="btn" type="button">提取地点</button>
          </div>
          <p id="mapPlacesActionStatus" class="note">等待提取</p>
        </div>
        <p id="mapPlacesStatus" class="note">正在加载地点</p>
        <ul id="mapPlacesList" class="summary-list"></ul>
      </section>

      <section id="summaryTipsCard" class="card summary-card" hidden>
        <h2>南非是否有小费文化</h2>
        <ul id="tipCultureList" class="summary-list"></ul>
      </section>
    </main>

    <footer>
      <small>提示：路线、路况、开闭园时间与接送时刻以当天官方公告和现场人员指引为准。</small>
    </footer>

    <script src="app.js?v=20260208-7" defer></script>
  </body>
</html>
